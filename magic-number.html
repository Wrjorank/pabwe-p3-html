<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Magic Number Game</title>

    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.13.1/font/bootstrap-icons.min.css"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <style>

      html, body {
        height: 100%;
      }
      body {
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }
      .container {
        flex: 1 0 auto;
      }
      footer {
        flex-shrink: 0;
      }

      /* Force scrollbar to always show */
      body {
        overflow-y: scroll;
      }
      
      /* Styles are kept for consistency, although not all are used here */
      .sortable-ghost { opacity: 0.4; background-color: #f8f9fa; }
      .sortable-chosen { background-color: #e3f2fd; }
      .sortable-drag { background-color: #ffffff; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
      .drag-handle { cursor: grab; }
      .drag-handle:active { cursor: grabbing; }
      .todo-item { transition: all 0.3s ease; }
      .todo-item:hover { background-color: #f8f9fa; }
      .edit-mode { background-color: #fff3cd !important; }
    </style>
  </head>
  <body>
    <div class="container mt-5">
      <ul class="nav nav-tabs mb-3" id="mainTabs">
        <li class="nav-item">
          <a class="nav-link" href="index.html">Todo List</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="magic-number.html">Magic Number</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="password-checker.html">Password Checker</a>
        </li>
      </ul>

      <div id="magic-number">
        <div class="row justify-content-center">
          <div class="col-md-10">
            <h1 class="text-start mb-4">Magic Number</h1>
            
            <!-- Game Info Card -->
            <div class="card mb-4">
              <div class="card-body">
                <div class="alert alert-info mb-0" role="alert">
                  <i class="bi bi-info-circle me-2"></i>
                  Ini merupakan permain sederhana dimana pemain akan menebak angka antara
                  1 sampai 100. Jika tebakan benar permainan selesai, jika tebakan salah
                  maka akan diberitahukan apakah tebakan terlalu tinggi atau terlalu
                  rendah.
                </div>
              </div>
            </div>

            <!-- Success Card -->
            <div class="card mb-4" id="tampilanBerhasil" style="display: none">
              <div class="card-body text-center">
                <div class="mb-3">
                  <i class="bi bi-trophy-fill text-warning display-3"></i>
                </div>
                <h2 class="text-success mb-3">Selamat tebakan kamu benar!</h2>
                <div class="mb-4">
                  <h4 class="text-primary">
                    Jumlah tebakan: <span class="badge bg-primary" id="jumlahTebakan1">0</span>
                  </h4>
                </div>
                <button class="btn btn-primary btn-lg" id="resetGame">
                  <i class="bi bi-arrow-clockwise me-2"></i>Main Lagi
                </button>
              </div>
            </div>

            <!-- Game Form Card -->
            <div class="card" id="gameFormCard">
              <div class="card-body">
                <h5 class="card-title">
                  <i class="bi bi-dice-1 me-2"></i>
                  Tebak Angka Magis
                </h5>
                <form id="magicFormData">
                  <div class="mb-3">
                    <label for="tebakanInput" class="form-label">
                      Masukkan tebakan Anda (1-100):
                    </label>
                    <div class="input-group">
                      <span class="input-group-text">
                        <i class="bi bi-hash"></i>
                      </span>
                      <input
                        type="number"
                        class="form-control form-control-lg"
                        name="tebakan"
                        id="tebakanInput"
                        min="1"
                        max="100"
                        placeholder="Masukkan angka..."
                        autofocus
                      />
                      <button type="submit" class="btn btn-primary">
                        <i class="bi bi-send"></i>
                      </button>
                    </div>
                    <div class="invalid-feedback" id="tebakanHint"></div>
                  </div>
                </form>

                <!-- Game Statistics -->
                <div class="row text-center mt-4">
                  <div class="col-6">
                    <h5 class="text-primary" id="jumlahTebakan2">0</h5>
                    <small class="text-muted">Jumlah Tebakan</small>
                  </div>
                  <div class="col-6">
                    <h5 class="text-info">1 - 100</h5>
                    <small class="text-muted">Range Angka</small>
                  </div>
                </div>
              </div>
            </div>

            <!-- Game History Card -->
            <div class="card mt-4" id="historyCard" style="display: none;">
              <div class="card-body">
                <h5 class="card-title">
                  <i class="bi bi-clock-history me-2"></i>
                  Riwayat Tebakan
                </h5>
                <ul class="list-group list-group-flush" id="guessHistory">
                  <!-- History items will be added here -->
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Magic Number Game
      class MagicNumberGame {
        constructor() {
          this.magicNumber = null;
          this.jumlahTebakan = 0;
          this.guessHistory = [];
          this.init();
        }

        init() {
          this.resetGame();
          this.bindEvents();
        }

        resetGame() {
          this.magicNumber = Math.floor(Math.random() * 100) + 1;
          this.jumlahTebakan = 0;
          this.guessHistory = [];

          document.getElementById("tampilanBerhasil").style.display = "none";
          document.getElementById("gameFormCard").style.display = "block";
          document.getElementById("historyCard").style.display = "none";
          document.getElementById("jumlahTebakan2").textContent = "0";
          document.getElementById("tebakanInput").value = "";
          document.getElementById("tebakanInput").classList.remove("is-invalid");
          document.getElementById("tebakanHint").textContent = "";
          document.getElementById("guessHistory").innerHTML = "";
          
          // Focus on input
          document.getElementById("tebakanInput").focus();
        }

        bindEvents() {
          document
            .getElementById("magicFormData")
            .addEventListener("submit", (e) => {
              e.preventDefault();
              this.handleGuess();
            });

          document.getElementById("resetGame").addEventListener("click", () => {
            this.resetGame();
          });

          // Allow Enter key to submit
          document.getElementById("tebakanInput").addEventListener("keydown", (e) => {
            if (e.key === "Enter") {
              e.preventDefault();
              this.handleGuess();
            }
          });
        }

        handleGuess() {
          const tebakanInput = document.getElementById("tebakanInput");
          const tebakanHint = document.getElementById("tebakanHint");
          const tebakan = parseInt(tebakanInput.value, 10);

          if (isNaN(tebakan) || tebakan < 1 || tebakan > 100) {
            tebakanHint.textContent =
              "Tebakan harus berupa angka antara 1 dan 100.";
            tebakanInput.classList.add("is-invalid");
            return;
          }

          // Check if number was already guessed
          if (this.guessHistory.some(guess => guess.number === tebakan)) {
            tebakanHint.textContent = "Angka ini sudah pernah ditebak!";
            tebakanInput.classList.add("is-invalid");
            return;
          }

          this.jumlahTebakan++;
          let result = "";
          let resultClass = "";
          let resultIcon = "";

          if (tebakan === this.magicNumber) {
            tebakanInput.classList.remove("is-invalid");
            tebakanHint.textContent = "";
            
            // Add to history
            this.guessHistory.push({
              number: tebakan,
              result: "Benar! 🎉",
              class: "text-success"
            });
            
            this.updateHistory();
            
            // Show success
            document.getElementById("tampilanBerhasil").style.display = "block";
            document.getElementById("gameFormCard").style.display = "none";
            document.getElementById("jumlahTebakan1").textContent = this.jumlahTebakan;
            
          } else if (tebakan < this.magicNumber) {
            result = "Terlalu rendah ⬆️";
            resultClass = "text-warning";
            tebakanHint.textContent = "Tebakan Kamu terlalu rendah";
            tebakanInput.classList.add("is-invalid");
            
          } else {
            result = "Terlalu tinggi ⬇️";
            resultClass = "text-danger";
            tebakanHint.textContent = "Tebakan Kamu terlalu tinggi";
            tebakanInput.classList.add("is-invalid");
          }

          if (tebakan !== this.magicNumber) {
            // Add to history
            this.guessHistory.push({
              number: tebakan,
              result: result,
              class: resultClass
            });
            
            this.updateHistory();
            document.getElementById("jumlahTebakan2").textContent = this.jumlahTebakan;
          }

          // Clear input for next guess
          tebakanInput.value = "";
          tebakanInput.focus();
        }

        updateHistory() {
          const historyContainer = document.getElementById("guessHistory");
          const historyCard = document.getElementById("historyCard");
          
          if (this.guessHistory.length > 0) {
            historyCard.style.display = "block";
            historyContainer.innerHTML = "";
            
            // Show last 10 guesses, most recent first
            const recentGuesses = this.guessHistory.slice(-10).reverse();
            
            recentGuesses.forEach((guess, index) => {
              const li = document.createElement("li");
              li.className = "list-group-item d-flex justify-content-between align-items-center";
              li.innerHTML = `
                <div>
                  <strong>${guess.number}</strong>
                  <small class="text-muted ms-2">#${this.guessHistory.length - index}</small>
                </div>
                <span class="${guess.class}">${guess.result}</span>
              `;
              historyContainer.appendChild(li);
            });
          }
        }
      }

      // Initialize application when DOM is ready
      document.addEventListener("DOMContentLoaded", () => {
        new MagicNumberGame();
      });
    </script>

    <footer class="bg-light text-center text-muted py-3 mt-5 border-top shadow-sm">
      <div>
        Web created by <span class="fw-bold text-primary">@Wahyu Rizky</span>
      </div>
    </footer>

</body>
</html>